<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>F1 AÅŸk Oyunu ðŸ’–</title>

<link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">

<style>
body{
    margin:0;
    background:black;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100dvh;
    overflow:hidden;
}

#gameContainer{
    position:relative;
}

canvas{
    image-rendering: pixelated;
    transition: opacity 3s ease;
}

#message{
    position:absolute;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    font-family:'Pacifico', cursive;
    font-size:32px;
    color:#ff4b5c;
    opacity:0;
    transition: opacity 4s ease;
    text-align:center;
}

/* ðŸ“± MOBÄ°L YÃ–N TUÅžLARI */
#controls{
    position:fixed;
    bottom:20px;
    left:50%;
    transform:translateX(-50%);
    display:grid;
    grid-template-columns: 70px 70px 70px;
    grid-template-rows: 70px 70px 70px;
    gap:10px;
}

.btn{
    background:#ff4b5c;
    border:none;
    color:white;
    font-size:28px;
    border-radius:15px;
    font-weight:bold;
}

.empty{ visibility:hidden; }
</style>
</head>
<body>

<div id="gameContainer">
    <canvas id="game"></canvas>
    <div id="message">ðŸ’– SENÄ° Ã‡OK SEVÄ°YORUM ðŸ’–</div>
</div>

<!-- MOBÄ°L TUÅžLAR -->
<div id="controls">
    <div class="empty"></div>
    <button class="btn" ontouchstart="startMove(0,-1)" ontouchend="stopMove()">â–²</button>
    <div class="empty"></div>

    <button class="btn" ontouchstart="startMove(-1,0)" ontouchend="stopMove()">â—€</button>
    <div class="empty"></div>
    <button class="btn" ontouchstart="startMove(1,0)" ontouchend="stopMove()">â–¶</button>

    <div class="empty"></div>
    <button class="btn" ontouchstart="startMove(0,1)" ontouchend="stopMove()">â–¼</button>
    <div class="empty"></div>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const rows = 12;
const cols = 12;

function resizeGame(){
    const size = Math.min(window.innerWidth, window.innerHeight-180);
    canvas.width = size;
    canvas.height = size;
}
resizeGame();
window.addEventListener("resize", resizeGame);

const map = [...]; // HARÄ°TAN BURAYA AYNI KALACAK

let player = {x:1,y:1};
let flowers = [];
let score = 0;
const totalFlowers = 10;
let gameFinished = false;
let moveInterval = null;

while(flowers.length < totalFlowers){
    let rx = Math.floor(Math.random()*cols);
    let ry = Math.floor(Math.random()*rows);
    if(map[ry][rx]===0 && !(rx===1 && ry===1)){
        flowers.push({x:rx,y:ry});
    }
}

function tileSize(){ return canvas.width / cols; }

function drawMap(){
    for(let y=0;y<rows;y++){
        for(let x=0;x<cols;x++){
            if(map[y][x]===1){
                ctx.fillStyle="#0033ff";
                ctx.fillRect(x*tileSize(),y*tileSize(),tileSize(),tileSize());
            }
        }
    }
}

function drawFlowers(){
    ctx.font = tileSize()*0.6 + "px Arial";
    flowers.forEach(f=>{
        ctx.fillText("ðŸŒ¸",f.x*tileSize()+tileSize()*0.2,f.y*tileSize()+tileSize()*0.75);
    });
}

function drawPlayer(){
    const size = tileSize();
    const x = player.x * size;
    const y = player.y * size;
    const px = size / 14;

    ctx.fillStyle = "#e10600";
    ctx.fillRect(x + px*4, y + px*5, px*6, px*5);
    ctx.fillRect(x + px*5, y + px*4, px*4, px*2);
    ctx.fillRect(x + px*6, y + px*3, px*2, px*2);

    ctx.fillStyle = "#111";
    ctx.fillRect(x + px*6, y + px*6, px*4, px*3);

    ctx.fillStyle = "#666";
    ctx.fillRect(x + px*7, y + px*6, px*1, px*1);

    ctx.fillStyle = "#ffffff";
    ctx.fillRect(x + px*6, y + px*4, px*2, px*1);

    ctx.fillStyle = "#b00000";
    ctx.fillRect(x + px*6, y + px*9, px*3, px*1);
}

function move(dx,dy){
    if(gameFinished) return;
    const nx = player.x + dx;
    const ny = player.y + dy;

    if(map[ny] && map[ny][nx]===0){
        player.x = nx;
        player.y = ny;
    }

    flowers = flowers.filter(f=>{
        if(f.x===player.x && f.y===player.y){
            score++;
            return false;
        }
        return true;
    });

    if(score===totalFlowers) endGame();
}

function startMove(dx,dy){
    move(dx,dy);
    moveInterval = setInterval(()=>move(dx,dy),200);
}

function stopMove(){
    clearInterval(moveInterval);
}

function endGame(){
    gameFinished = true;
    canvas.style.opacity = "0";
    setTimeout(()=>{
        document.getElementById("message").style.opacity = "1";
    },1500);
}

document.addEventListener("keydown",e=>{
    if(e.key==="ArrowLeft") move(-1,0);
    if(e.key==="ArrowRight") move(1,0);
    if(e.key==="ArrowUp") move(0,-1);
    if(e.key==="ArrowDown") move(0,1);
});

function gameLoop(){
    if(!gameFinished){
        ctx.clearRect(0,0,canvas.width,canvas.height);
        drawMap();
        drawFlowers();
        drawPlayer();
    }
    requestAnimationFrame(gameLoop);
}
gameLoop();
</script>

</body>
</html>